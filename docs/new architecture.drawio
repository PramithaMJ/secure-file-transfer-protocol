<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36" version="28.0.6">
  <diagram name="Updated SFTP Architecture with PFS" id="updated-sftp-architecture">
    <mxGraphModel dx="2066" dy="1184" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1800" pageHeight="1600" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="Secure File Transfer Protocol - Enhanced Architecture with Perfect Forward Secrecy" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="400" y="20" width="800" height="40" as="geometry" />
        </mxCell>
        <mxCell id="alice-container" value="ALICE CLIENT" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14" parent="1" vertex="1">
          <mxGeometry x="50" y="100" width="320" height="480" as="geometry" />
        </mxCell>
        <mxCell id="alice-ui" value="ClientUI.java&#xa;- Swing GUI Interface&#xa;- File selection and transfer progress&#xa;- Transfer history panel&#xa;- Pause/Resume controls" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="alice-container" vertex="1">
          <mxGeometry x="10" y="40" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="alice-client" value="Client.java&#xa;- Core transfer logic&#xa;- Session management&#xa;- Transfer state tracking&#xa;- EventListener implementation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="alice-container" vertex="1">
          <mxGeometry x="10" y="110" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="alice-handler" value="ClientConnectionHandler.java&#xa;- TCP socket management&#xa;- Message processing&#xa;- Network I/O handling" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="alice-container" vertex="1">
          <mxGeometry x="10" y="180" width="300" height="50" as="geometry" />
        </mxCell>
        <mxCell id="alice-history" value="TransferHistory.java&#xa;- Local transfer records&#xa;- Persistent storage&#xa;- Status tracking (IN_PROGRESS, PAUSED, COMPLETED)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="alice-container" vertex="1">
          <mxGeometry x="10" y="240" width="300" height="50" as="geometry" />
        </mxCell>
        <mxCell id="alice-security-title" value="ALICE SECURITY OPERATIONS" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="alice-container" vertex="1">
          <mxGeometry x="85" y="300" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="alice-crypto" value="Perfect Forward Secrecy (PFS)&#xa;• Generate ephemeral DH key pairs&#xa;• Secure key exchange via server&#xa;• Forward secrecy guarantee" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10" parent="alice-container" vertex="1">
          <mxGeometry x="10" y="330" width="145" height="60" as="geometry" />
        </mxCell>
        <mxCell id="alice-encryption" value="Multi-layer Encryption&#xa;• RSA-2048 for key exchange&#xa;• AES-256-GCM for data&#xa;• HMAC-SHA256 for integrity" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10" parent="alice-container" vertex="1">
          <mxGeometry x="165" y="330" width="145" height="60" as="geometry" />
        </mxCell>
        <mxCell id="alice-replay" value="Anti-Replay Protection&#xa;• Unique nonce per chunk&#xa;• Timestamp validation&#xa;• Sequence number tracking" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10" parent="alice-container" vertex="1">
          <mxGeometry x="10" y="400" width="145" height="60" as="geometry" />
        </mxCell>
        <mxCell id="alice-digital-sig" value="Digital Signatures&#xa;• RSA signature verification&#xa;• Non-repudiation guarantee&#xa;• Message authenticity" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10" parent="alice-container" vertex="1">
          <mxGeometry x="165" y="400" width="145" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bob-container" value="BOB CLIENT" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14" parent="1" vertex="1">
          <mxGeometry x="50" y="620" width="320" height="480" as="geometry" />
        </mxCell>
        <mxCell id="bob-ui" value="ClientUI.java&#xa;- Swing GUI Interface&#xa;- File reception dialogs&#xa;- Transfer monitoring&#xa;- History management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="bob-container" vertex="1">
          <mxGeometry x="10" y="40" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bob-client" value="Client.java&#xa;- File reception logic&#xa;- Chunk reassembly&#xa;- Download directory management&#xa;- Progress tracking" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="bob-container" vertex="1">
          <mxGeometry x="10" y="110" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bob-handler" value="ClientConnectionHandler.java&#xa;- Message queue processing&#xa;- Chunk validation&#xa;- File reconstruction" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="bob-container" vertex="1">
          <mxGeometry x="10" y="180" width="300" height="50" as="geometry" />
        </mxCell>
        <mxCell id="bob-history" value="TransferHistory.java&#xa;- Received file tracking&#xa;- Transfer metadata&#xa;- Completion status" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="bob-container" vertex="1">
          <mxGeometry x="10" y="240" width="300" height="50" as="geometry" />
        </mxCell>
        <mxCell id="bob-security-title" value="BOB SECURITY OPERATIONS" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="bob-container" vertex="1">
          <mxGeometry x="85" y="300" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="bob-pfs" value="PFS Key Reception&#xa;• Receive ephemeral DH public key&#xa;• Generate shared secret&#xa;• Derive session keys" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10" parent="bob-container" vertex="1">
          <mxGeometry x="10" y="330" width="145" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bob-decryption" value="Secure Decryption&#xa;• AES-GCM decryption&#xa;• Key derivation from DH&#xa;• Chunk integrity verification" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10" parent="bob-container" vertex="1">
          <mxGeometry x="165" y="330" width="145" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bob-validation" value="Message Validation&#xa;• HMAC verification&#xa;• Timestamp checking&#xa;• Nonce uniqueness" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10" parent="bob-container" vertex="1">
          <mxGeometry x="10" y="400" width="145" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bob-signature" value="Signature Verification&#xa;• RSA signature check&#xa;• Sender authentication&#xa;• Message integrity" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10" parent="bob-container" vertex="1">
          <mxGeometry x="165" y="400" width="145" height="60" as="geometry" />
        </mxCell>
        <mxCell id="server-container" value="CENTRAL SFTP SERVER" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#f5f5f5;strokeColor=#666666;fontSize=16" parent="1" vertex="1">
          <mxGeometry x="450" y="100" width="400" height="800" as="geometry" />
        </mxCell>
        <mxCell id="server-main" value="Server.java&#xa;Main Server Process - Port 9999&#xa;Multi-threaded connection handling" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" parent="server-container" vertex="1">
          <mxGeometry x="50" y="40" width="300" height="50" as="geometry" />
        </mxCell>
        <mxCell id="server-connection-mgmt" value="ServerConnectionHandler.java&#xa;• Thread pool management&#xa;• Client session handling&#xa;• Message routing between clients" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" parent="server-container" vertex="1">
          <mxGeometry x="50" y="100" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="user-manager" value="UserManager.java&#xa;• User authentication&#xa;• Online user registry&#xa;• Public key management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" parent="server-container" vertex="1">
          <mxGeometry x="50" y="170" width="300" height="50" as="geometry" />
        </mxCell>
        <mxCell id="dos-title" value="ENHANCED DoS PROTECTION SYSTEM" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="server-container" vertex="1">
          <mxGeometry x="100" y="240" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rate-limit-manager" value="RateLimitManager.java&#xa;• Connection limiting per IP&#xa;• Request rate limiting (60/min)&#xa;• Login attempt limiting (per hour)&#xa;• Bandwidth control&#xa;• Automatic IP blacklisting" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" parent="server-container" vertex="1">
          <mxGeometry x="25" y="270" width="175" height="90" as="geometry" />
        </mxCell>
        <mxCell id="dos-monitor" value="DoSMonitor.java&#xa;• Real-time threat assessment&#xa;• Automated response system&#xa;• Security metrics collection&#xa;• Alert thresholds:&#xa;  - High connections (50+)&#xa;  - Multiple blacklisted IPs (5+)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" parent="server-container" vertex="1">
          <mxGeometry x="210" y="270" width="165" height="90" as="geometry" />
        </mxCell>
        <mxCell id="session-title" value="SESSION MANAGEMENT" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="server-container" vertex="1">
          <mxGeometry x="100" y="380" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="session-manager" value="SessionManager.java&#xa;• Session timeout management&#xa;• Activity tracking&#xa;• Automatic cleanup&#xa;• Session expiry warnings" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="server-container" vertex="1">
          <mxGeometry x="50" y="410" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="pfs-title" value="PERFECT FORWARD SECRECY (PFS) RELAY" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="server-container" vertex="1">
          <mxGeometry x="100" y="490" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="pfs-relay" value="DH Key Exchange Relay&#xa;• Forward ephemeral DH public keys&#xa;• Coordinate three-party key exchange&#xa;• No access to shared secrets&#xa;• Perfect forward secrecy maintained" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" parent="server-container" vertex="1">
          <mxGeometry x="50" y="520" width="300" height="70" as="geometry" />
        </mxCell>
        <mxCell id="logging-title" value="COMPREHENSIVE LOGGING SYSTEM" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="server-container" vertex="1">
          <mxGeometry x="100" y="610" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="logging-manager" value="LoggingManager.java&#xa;• Security event logging&#xa;• Transfer operation logs&#xa;• Cryptographic operation logs&#xa;• Automated log rotation (5MB files)&#xa;• Audit trail maintenance" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="server-container" vertex="1">
          <mxGeometry x="50" y="640" width="300" height="80" as="geometry" />
        </mxCell>
        <mxCell id="storage-title" value="SECURE FILE HANDLING" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" parent="server-container" vertex="1">
          <mxGeometry x="100" y="740" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="file-storage" value="downloads/ directory&#xa;• Temporary file storage&#xa;• Chunk reassembly&#xa;• Transfer completion cleanup" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" parent="server-container" vertex="1">
          <mxGeometry x="50" y="770" width="300" height="20" as="geometry" />
        </mxCell>
        <mxCell id="shared-container" value="SHARED SECURITY COMPONENTS" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=16" parent="1" vertex="1">
          <mxGeometry x="920" y="100" width="400" height="800" as="geometry" />
        </mxCell>
        <mxCell id="crypto-utils" value="CryptoUtils.java - Enhanced Cryptographic Suite&#xa;&#xa;Perfect Forward Secrecy Implementation:&#xa;• generateEphemeralDHKeyPair() - Ephemeral key generation&#xa;• computeSharedSecret() - DH shared secret computation&#xa;• deriveAESKey() - Key derivation from shared secret&#xa;• secureWipe() - Secure memory cleanup&#xa;&#xa;Multi-layer Encryption:&#xa;• RSA-2048 for asymmetric operations&#xa;• AES-256-GCM for symmetric encryption&#xa;• HMAC-SHA256 for message authentication&#xa;&#xa;Enhanced Anti-Replay:&#xa;• generateSecureNonce() - UUID-based nonces&#xa;• verifyIntegrity() - Enhanced integrity checking&#xa;• Sequence number validation&#xa;• Transfer completion cleanup" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left" parent="shared-container" vertex="1">
          <mxGeometry x="20" y="50" width="360" height="200" as="geometry" />
        </mxCell>
        <mxCell id="message-protocol" value="Enhanced Message Protocol&#xa;&#xa;SecureMessage.java:&#xa;• Encrypted data payload (AES-GCM)&#xa;• Initialization Vector (IV)&#xa;• HMAC for integrity&#xa;• Timestamp for freshness&#xa;• Unique nonce for replay protection&#xa;• Sequence numbers for ordering&#xa;&#xa;SignedSecureMessage.java:&#xa;• Digital signature (RSA)&#xa;• Non-repudiation guarantee&#xa;• Message authenticity verification" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left" parent="shared-container" vertex="1">
          <mxGeometry x="20" y="270" width="360" height="140" as="geometry" />
        </mxCell>
        <mxCell id="transfer-mgmt" value="Transfer Management System&#xa;&#xa;FileTransferRequest.java:&#xa;• Transfer metadata and permissions&#xa;• Encrypted symmetric keys&#xa;• File integrity information&#xa;&#xa;TransferRecord.java:&#xa;• Transfer history tracking&#xa;• Status management (IN_PROGRESS, PAUSED, COMPLETED)&#xa;• Performance metrics&#xa;• Pause/Resume functionality&#xa;&#xa;TransferHistory.java:&#xa;• Persistent transfer records&#xa;• User-specific history&#xa;• Audit trail maintenance" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left" parent="shared-container" vertex="1">
          <mxGeometry x="20" y="430" width="360" height="160" as="geometry" />
        </mxCell>
        <mxCell id="security-testing" value="Security Testing and Validation&#xa;&#xa;ReplayTestUtils.java:&#xa;• Anti-replay protection testing&#xa;• Attack simulation scenarios&#xa;• Security validation suite&#xa;• Comprehensive test coverage:&#xa;  - Duplicate detection&#xa;  - Sequence validation&#xa;  - Transfer completion cleanup&#xa;  - Replay attack simulation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left" parent="shared-container" vertex="1">
          <mxGeometry x="20" y="610" width="360" height="120" as="geometry" />
        </mxCell>
        <mxCell id="user-system" value="User Management System&#xa;&#xa;User.java and Participant.java:&#xa;• RSA key pair management&#xa;• Online status tracking&#xa;• Public key serialization&#xa;• User authentication framework" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left" parent="shared-container" vertex="1">
          <mxGeometry x="20" y="750" width="360" height="40" as="geometry" />
        </mxCell>
        <mxCell id="security-flow-container" value="ENHANCED SECURITY FLOW WITH PFS" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fillColor=#f0f0f0;strokeColor=#666666;fontSize=16" parent="1" vertex="1">
          <mxGeometry x="50" y="1150" width="1270" height="400" as="geometry" />
        </mxCell>
        <mxCell id="pfs-step1" value="STEP 1: Initial Authentication&#xa;Alice → Server: RSA public key&#xa;Server validates and registers Alice" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10" parent="security-flow-container" vertex="1">
          <mxGeometry x="20" y="50" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="pfs-step2" value="STEP 2: Bob Authentication&#xa;Bob → Server: RSA public key&#xa;Server validates and registers Bob" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10" parent="security-flow-container" vertex="1">
          <mxGeometry x="180" y="50" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="pfs-step3" value="STEP 3: Ephemeral Key Generation&#xa;Alice generates DH key pair&#xa;generateEphemeralDHKeyPair()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10" parent="security-flow-container" vertex="1">
          <mxGeometry x="340" y="50" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="pfs-step4" value="STEP 4: DH Public Key Exchange&#xa;Alice → Server → Bob:&#xa;Ephemeral DH public key" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10" parent="security-flow-container" vertex="1">
          <mxGeometry x="500" y="50" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="pfs-step5" value="STEP 5: Bob DH Key Generation&#xa;Bob generates DH key pair&#xa;Bob → Server → Alice:&#xa;Bob&#39;s DH public key" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10" parent="security-flow-container" vertex="1">
          <mxGeometry x="660" y="50" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="pfs-step6" value="STEP 6: Shared Secret Computation&#xa;Both Alice and Bob compute:&#xa;sharedSecret = g^(ab) mod p&#xa;Derive AES keys from secret" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10" parent="security-flow-container" vertex="1">
          <mxGeometry x="820" y="50" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="pfs-step7" value="STEP 7: Secure File Transfer&#xa;Alice encrypts file chunks with&#xa;derived AES keys + unique IVs&#xa;Server relays to Bob" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=10" parent="security-flow-container" vertex="1">
          <mxGeometry x="980" y="50" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="pfs-step8" value="STEP 8: Transfer Completion&#xa;Both parties securely wipe&#xa;ephemeral keys from memory&#xa;Perfect forward secrecy achieved" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcccc;strokeColor=#ff6666;fontSize=10" parent="security-flow-container" vertex="1">
          <mxGeometry x="1140" y="50" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="enhanced-security-title" value="ENHANCED SECURITY FEATURES" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" parent="security-flow-container" vertex="1">
          <mxGeometry x="500" y="130" width="300" height="20" as="geometry" />
        </mxCell>
        <mxCell id="sec-feature1" value="Perfect Forward Secrecy&#xa;Ephemeral DH keys ensure&#xa;past communications remain&#xa;secure even if long-term&#xa;keys are compromised" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9" parent="security-flow-container" vertex="1">
          <mxGeometry x="20" y="160" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sec-feature2" value="Enhanced Anti-Replay&#xa;• UUID-based nonces&#xa;• Timestamp validation&#xa;• Sequence tracking&#xa;• Transfer-specific cleanup" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9" parent="security-flow-container" vertex="1">
          <mxGeometry x="150" y="160" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sec-feature3" value="Comprehensive DoS Protection&#xa;• Multi-layer rate limiting&#xa;• Automated IP blacklisting&#xa;• Real-time threat assessment&#xa;• Bandwidth controls" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9" parent="security-flow-container" vertex="1">
          <mxGeometry x="280" y="160" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sec-feature4" value="Session Management&#xa;• Automatic timeout handling&#xa;• Activity monitoring&#xa;• Session expiry warnings&#xa;• Graceful cleanup" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9" parent="security-flow-container" vertex="1">
          <mxGeometry x="410" y="160" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sec-feature5" value="Transfer Resume/Pause&#xa;• Chunk-level granularity&#xa;• State persistence&#xa;• Progress tracking&#xa;• Reliable recovery" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9" parent="security-flow-container" vertex="1">
          <mxGeometry x="540" y="160" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sec-feature6" value="Comprehensive Logging&#xa;• Security event tracking&#xa;• Transfer operation logs&#xa;• Cryptographic operations&#xa;• Automated log rotation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9" parent="security-flow-container" vertex="1">
          <mxGeometry x="670" y="160" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sec-feature7" value="Message Integrity&#xa;• HMAC-SHA256 verification&#xa;• Digital signatures (RSA)&#xa;• Tamper detection&#xa;• Non-repudiation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9" parent="security-flow-container" vertex="1">
          <mxGeometry x="800" y="160" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sec-feature8" value="Multi-layer Encryption&#xa;• RSA-2048 (asymmetric)&#xa;• AES-256-GCM (symmetric)&#xa;• Key derivation (DH)&#xa;• Secure key exchange" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9" parent="security-flow-container" vertex="1">
          <mxGeometry x="930" y="160" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sec-feature9" value="Security Testing&#xa;• Replay attack simulation&#xa;• Automated test suite&#xa;• Vulnerability assessment&#xa;• Continuous validation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9" parent="security-flow-container" vertex="1">
          <mxGeometry x="1060" y="160" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="tech-specs" value="TECHNICAL SPECIFICATIONS&#xa;&#xa;Transport: TCP/IP Socket Communication (Port 9999)&#xa;Asymmetric Encryption: RSA-2048 with OAEP padding&#xa;Symmetric Encryption: AES-256-GCM with random IVs&#xa;Key Exchange: Diffie-Hellman 2048-bit ephemeral keys&#xa;Message Authentication: HMAC-SHA256&#xa;Digital Signatures: RSA with SHA-256&#xa;Anti-Replay: UUID nonces + timestamps + sequence numbers&#xa;Chunking: 4KB chunks with individual encryption&#xa;Session Management: Timeout-based with activity tracking&#xa;DoS Protection: Multi-layer rate limiting with auto-blacklisting&#xa;Logging: Comprehensive audit trail with log rotation&#xa;Perfect Forward Secrecy: Ephemeral key exchange with secure wiping" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left" parent="security-flow-container" vertex="1">
          <mxGeometry x="20" y="260" width="1230" height="120" as="geometry" />
        </mxCell>
        <mxCell id="alice-to-server" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#6c8ebf;strokeWidth=3;dashed=0" parent="1" source="alice-container" target="server-container" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="400" y="600" as="sourcePoint" />
            <mxPoint x="450" y="550" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="alice-label" value="Alice → Server&#xa;TCP:9999&#xa;PFS Key Exchange&#xa;Encrypted File Transfer" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#6c8ebf;fontStyle=1" parent="alice-to-server" vertex="1" connectable="0">
          <mxGeometry x="-0.1" y="2" relative="1" as="geometry">
            <mxPoint x="20" y="-30" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bob-to-server" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#b85450;strokeWidth=3;dashed=0" parent="1" source="bob-container" target="server-container" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="400" y="700" as="sourcePoint" />
            <mxPoint x="450" y="650" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bob-label" value="Bob → Server&#xa;TCP:9999&#xa;PFS Key Exchange&#xa;Encrypted File Reception" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#b85450;fontStyle=1" parent="bob-to-server" vertex="1" connectable="0">
          <mxGeometry x="-0.1" y="2" relative="1" as="geometry">
            <mxPoint x="20" y="30" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="server-to-shared" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#666666;strokeWidth=2;dashed=0" parent="1" source="server-container" target="shared-container" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="850" y="500" as="sourcePoint" />
            <mxPoint x="920" y="500" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="shared-label" value="Uses Enhanced&#xa;Security Components" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#666666;fontStyle=1" parent="server-to-shared" vertex="1" connectable="0">
          <mxGeometry x="-0.1" y="2" relative="1" as="geometry">
            <mxPoint y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-arrow1" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#6c8ebf;strokeWidth=2" parent="1" source="pfs-step1" target="pfs-step2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="180" y="1230" as="sourcePoint" />
            <mxPoint x="200" y="1230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-arrow2" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#6c8ebf;strokeWidth=2" parent="1" source="pfs-step2" target="pfs-step3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="340" y="1230" as="sourcePoint" />
            <mxPoint x="360" y="1230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-arrow3" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#6c8ebf;strokeWidth=2" parent="1" source="pfs-step3" target="pfs-step4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="1230" as="sourcePoint" />
            <mxPoint x="520" y="1230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-arrow4" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#6c8ebf;strokeWidth=2" parent="1" source="pfs-step4" target="pfs-step5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="660" y="1230" as="sourcePoint" />
            <mxPoint x="680" y="1230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-arrow5" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#6c8ebf;strokeWidth=2" parent="1" source="pfs-step5" target="pfs-step6" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="820" y="1230" as="sourcePoint" />
            <mxPoint x="840" y="1230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-arrow6" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#6c8ebf;strokeWidth=2" parent="1" source="pfs-step6" target="pfs-step7" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="980" y="1230" as="sourcePoint" />
            <mxPoint x="1000" y="1230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-arrow7" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#6c8ebf;strokeWidth=2" parent="1" source="pfs-step7" target="pfs-step8" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1140" y="1230" as="sourcePoint" />
            <mxPoint x="1160" y="1230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
